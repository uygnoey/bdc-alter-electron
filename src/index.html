<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; frame-src *; img-src * data:;">
    <title>Electron Web Browser / ì¼ë ‰íŠ¸ë¡  ì›¹ ë¸Œë¼ìš°ì €</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: #f5f5f5;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* Navigation bar / ë„¤ë¹„ê²Œì´ì…˜ ë°” */
        .nav-bar {
            background: #ffffff;
            padding: 10px;
            display: flex;
            gap: 10px;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .nav-buttons {
            display: flex;
            gap: 5px;
        }

        button {
            padding: 8px 16px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.2s;
        }

        button:hover {
            background: #f0f0f0;
        }

        button:active {
            background: #e0e0e0;
        }

        #url-input {
            flex: 1;
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }

        #url-input:focus {
            outline: none;
            border-color: #4CAF50;
        }

        /* Tab container / íƒ­ ì»¨í…Œì´ë„ˆ */
        .tab-container {
            background: #e0e0e0;
            padding: 5px;
            display: flex;
            gap: 5px;
            align-items: center;
            min-height: 40px;
        }

        .tab {
            background: white;
            padding: 8px 16px;
            border-radius: 4px 4px 0 0;
            cursor: pointer;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
            max-width: 200px;
            position: relative;
        }

        .tab.active {
            background: #4CAF50;
            color: white;
        }

        .tab-title {
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            flex: 1;
        }

        .tab-close {
            width: 16px;
            height: 16px;
            border-radius: 50%;
            background: rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
        }

        .tab-close:hover {
            background: rgba(255,0,0,0.3);
        }

        #new-tab-btn {
            padding: 4px 8px;
            font-size: 18px;
            background: transparent;
            border: none;
        }

        /* Webview container / ì›¹ë·° ì»¨í…Œì´ë„ˆ */
        .webview-container {
            flex: 1;
            position: relative;
            background: white;
        }

        webview {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }

        webview.hidden {
            display: none;
        }

        /* Loading indicator / ë¡œë”© í‘œì‹œê¸° */
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 18px;
            color: #666;
        }

        /* Status bar / ìƒíƒœ í‘œì‹œì¤„ */
        .status-bar {
            background: #333;
            color: white;
            padding: 5px 10px;
            font-size: 12px;
            display: flex;
            justify-content: space-between;
        }
    </style>
</head>
<body>
    <!-- Tab Container / íƒ­ ì»¨í…Œì´ë„ˆ -->
    <div class="tab-container" id="tab-container">
        <button id="new-tab-btn" title="New Tab / ìƒˆ íƒ­">+</button>
    </div>

    <!-- Navigation Bar / ë„¤ë¹„ê²Œì´ì…˜ ë°” -->
    <div class="nav-bar">
        <div class="nav-buttons">
            <button id="back-btn" title="Back / ë’¤ë¡œ">â†</button>
            <button id="forward-btn" title="Forward / ì•ìœ¼ë¡œ">â†’</button>
            <button id="reload-btn" title="Reload / ìƒˆë¡œê³ ì¹¨">âŸ³</button>
            <button id="home-btn" title="Home / í™ˆ">ğŸ </button>
        </div>
        <input type="text" id="url-input" placeholder="Enter URL / URLì„ ì…ë ¥í•˜ì„¸ìš”" value="https://www.google.com">
        <button id="go-btn">Go / ì´ë™</button>
    </div>

    <!-- Webview Container / ì›¹ë·° ì»¨í…Œì´ë„ˆ -->
    <div class="webview-container" id="webview-container">
        <div class="loading">Loading... / ë¡œë”© ì¤‘...</div>
    </div>

    <!-- Status Bar / ìƒíƒœ í‘œì‹œì¤„ -->
    <div class="status-bar">
        <span id="status-text">Ready / ì¤€ë¹„ë¨</span>
        <span id="platform-info"></span>
    </div>

    <script>
        // Tab management / íƒ­ ê´€ë¦¬
        let tabs = [];
        let activeTabId = null;
        let tabIdCounter = 0;

        // Create new tab / ìƒˆ íƒ­ ìƒì„±
        function createTab(url = 'https://www.google.com') {
            const tabId = `tab-${tabIdCounter++}`;
            
            // Create tab element / íƒ­ ìš”ì†Œ ìƒì„±
            const tabElement = document.createElement('div');
            tabElement.className = 'tab';
            tabElement.id = tabId;
            tabElement.innerHTML = `
                <span class="tab-title">New Tab / ìƒˆ íƒ­</span>
                <span class="tab-close">Ã—</span>
            `;
            
            // Add tab to container / ì»¨í…Œì´ë„ˆì— íƒ­ ì¶”ê°€
            const newTabBtn = document.getElementById('new-tab-btn');
            document.getElementById('tab-container').insertBefore(tabElement, newTabBtn);
            
            // Create webview / ì›¹ë·° ìƒì„±
            const webview = document.createElement('webview');
            webview.id = `webview-${tabId}`;
            webview.src = url;
            webview.className = 'hidden';
            webview.setAttribute('nodeintegration', 'false');
            webview.setAttribute('webpreferences', 'contextIsolation=true');
            document.getElementById('webview-container').appendChild(webview);
            
            // Add to tabs array / íƒ­ ë°°ì—´ì— ì¶”ê°€
            tabs.push({
                id: tabId,
                element: tabElement,
                webview: webview,
                url: url
            });
            
            // Tab click event / íƒ­ í´ë¦­ ì´ë²¤íŠ¸
            tabElement.addEventListener('click', (e) => {
                if (!e.target.classList.contains('tab-close')) {
                    activateTab(tabId);
                }
            });
            
            // Close tab event / íƒ­ ë‹«ê¸° ì´ë²¤íŠ¸
            tabElement.querySelector('.tab-close').addEventListener('click', (e) => {
                e.stopPropagation();
                closeTab(tabId);
            });
            
            // Webview events / ì›¹ë·° ì´ë²¤íŠ¸
            webview.addEventListener('did-start-loading', () => {
                updateStatus('Loading... / ë¡œë”© ì¤‘...');
            });
            
            webview.addEventListener('did-stop-loading', () => {
                updateStatus('Ready / ì¤€ë¹„ë¨');
            });
            
            webview.addEventListener('page-title-updated', (e) => {
                const tab = tabs.find(t => t.id === tabId);
                if (tab) {
                    tab.element.querySelector('.tab-title').textContent = e.title || 'Untitled / ì œëª© ì—†ìŒ';
                }
            });
            
            webview.addEventListener('did-navigate', (e) => {
                const tab = tabs.find(t => t.id === tabId);
                if (tab && tab.id === activeTabId) {
                    document.getElementById('url-input').value = e.url;
                }
            });
            
            // Activate the new tab / ìƒˆ íƒ­ í™œì„±í™”
            activateTab(tabId);
        }

        // Activate tab / íƒ­ í™œì„±í™”
        function activateTab(tabId) {
            tabs.forEach(tab => {
                if (tab.id === tabId) {
                    tab.element.classList.add('active');
                    tab.webview.classList.remove('hidden');
                    document.getElementById('url-input').value = tab.webview.src;
                    activeTabId = tabId;
                } else {
                    tab.element.classList.remove('active');
                    tab.webview.classList.add('hidden');
                }
            });
        }

        // Close tab / íƒ­ ë‹«ê¸°
        function closeTab(tabId) {
            const tabIndex = tabs.findIndex(t => t.id === tabId);
            if (tabIndex === -1) return;
            
            const tab = tabs[tabIndex];
            tab.element.remove();
            tab.webview.remove();
            tabs.splice(tabIndex, 1);
            
            // If closing active tab, activate another / í™œì„± íƒ­ì„ ë‹«ëŠ” ê²½ìš° ë‹¤ë¥¸ íƒ­ í™œì„±í™”
            if (tabId === activeTabId && tabs.length > 0) {
                activateTab(tabs[tabs.length - 1].id);
            }
            
            // Create new tab if no tabs left / íƒ­ì´ ì—†ìœ¼ë©´ ìƒˆ íƒ­ ìƒì„±
            if (tabs.length === 0) {
                createTab();
            }
        }

        // Get active webview / í™œì„± ì›¹ë·° ê°€ì ¸ì˜¤ê¸°
        function getActiveWebview() {
            const activeTab = tabs.find(t => t.id === activeTabId);
            return activeTab ? activeTab.webview : null;
        }

        // Update status / ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateStatus(text) {
            document.getElementById('status-text').textContent = text;
        }

        // Navigation functions / ë„¤ë¹„ê²Œì´ì…˜ í•¨ìˆ˜
        document.getElementById('back-btn').addEventListener('click', () => {
            const webview = getActiveWebview();
            if (webview && webview.canGoBack()) {
                webview.goBack();
            }
        });

        document.getElementById('forward-btn').addEventListener('click', () => {
            const webview = getActiveWebview();
            if (webview && webview.canGoForward()) {
                webview.goForward();
            }
        });

        document.getElementById('reload-btn').addEventListener('click', () => {
            const webview = getActiveWebview();
            if (webview) {
                webview.reload();
            }
        });

        document.getElementById('home-btn').addEventListener('click', () => {
            const webview = getActiveWebview();
            if (webview) {
                webview.src = 'https://www.google.com';
                document.getElementById('url-input').value = 'https://www.google.com';
            }
        });

        // URL navigation / URL ë„¤ë¹„ê²Œì´ì…˜
        function navigateToUrl() {
            const webview = getActiveWebview();
            if (webview) {
                let url = document.getElementById('url-input').value;
                if (!url.startsWith('http://') && !url.startsWith('https://')) {
                    url = 'https://' + url;
                }
                webview.src = url;
            }
        }

        document.getElementById('go-btn').addEventListener('click', navigateToUrl);
        document.getElementById('url-input').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') {
                navigateToUrl();
            }
        });

        // New tab button / ìƒˆ íƒ­ ë²„íŠ¼
        document.getElementById('new-tab-btn').addEventListener('click', () => {
            createTab();
        });

        // Platform info / í”Œë«í¼ ì •ë³´
        if (window.electronAPI) {
            document.getElementById('platform-info').textContent = `Platform: ${window.electronAPI.platform}`;
        }

        // Initialize with one tab / í•˜ë‚˜ì˜ íƒ­ìœ¼ë¡œ ì´ˆê¸°í™”
        createTab();
    </script>
</body>
</html>